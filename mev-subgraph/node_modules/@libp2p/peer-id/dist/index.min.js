(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerId = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerId=(()=>{var wr=Object.defineProperty;var Ts=Object.getOwnPropertyDescriptor;var Ds=Object.getOwnPropertyNames;var Cs=Object.prototype.hasOwnProperty;var rt=(e,t)=>{for(var r in t)wr(e,r,{get:t[r],enumerable:!0})},Us=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ds(t))!Cs.call(e,o)&&o!==r&&wr(e,o,{get:()=>t[o],enumerable:!(n=Ts(t,o))||n.enumerable});return e};var Ks=e=>Us(wr({},"__esModule",{value:!0}),e);var uc={};rt(uc,{peerIdFromCID:()=>Ls,peerIdFromMultihash:()=>Cn,peerIdFromPrivateKey:()=>ac,peerIdFromPublicKey:()=>_s,peerIdFromString:()=>ic});var Er=Symbol.for("@libp2p/peer-id");var pt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},Ve=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var ze=class extends Error{static name="InvalidCIDError";constructor(t="Invalid CID"){super(t),this.name="InvalidCIDError"}},Fe=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var Zt=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Ir={};rt(Ir,{base58btc:()=>F,base58flickr:()=>Ms});var pc=new Uint8Array(0);function Un(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function xt(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Kn(e){return new TextEncoder().encode(e)}function Pn(e){return new TextDecoder().decode(e)}function Ps(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,f=e.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var E=0,m=0,A=0,T=S.length;A!==T&&S[A]===0;)A++,E++;for(var v=(T-A)*c+1>>>0,U=new Uint8Array(v);A!==T;){for(var p=S[A],C=0,D=v-1;(p!==0||C<m)&&D!==-1;D--,C++)p+=256*U[D]>>>0,U[D]=p%a>>>0,p=p/a>>>0;if(p!==0)throw new Error("Non-zero carry");m=C,A++}for(var I=v-m;I!==v&&U[I]===0;)I++;for(var u=f.repeat(E);I<v;++I)u+=e.charAt(U[I]);return u}function x(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var E=0;if(S[E]!==" "){for(var m=0,A=0;S[E]===f;)m++,E++;for(var T=(S.length-E)*l+1>>>0,v=new Uint8Array(T);S[E];){var U=r[S.charCodeAt(E)];if(U===255)return;for(var p=0,C=T-1;(U!==0||p<A)&&C!==-1;C--,p++)U+=a*v[C]>>>0,v[C]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");A=p,E++}if(S[E]!==" "){for(var D=T-A;D!==T&&v[D]===0;)D++;for(var I=new Uint8Array(m+(T-D)),u=m;D!==T;)I[u++]=v[D++];return I}}}function b(S){var E=x(S);if(E)return E;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:x,decode:b}}var Rs=Ps,Ns=Rs,Nn=Ns;var Sr=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Ar=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return On(this,t)}},Br=class{decoders;constructor(t){this.decoders=t}or(t){return On(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function On(e,t){return new Br({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}var vr=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Sr(t,r,n),this.decoder=new Ar(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function Yt({name:e,prefix:t,encode:r,decode:n}){return new vr(e,t,r,n)}function vt({name:e,prefix:t,alphabet:r}){let{encode:n,decode:o}=Nn(r,e);return Yt({prefix:t,name:e,encode:n,decode:s=>xt(o(s))})}function Os(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),i=0,a=0,f=0;for(let l=0;l<o;++l){let c=t[e[l]];if(c===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|c,i+=r,i>=8&&(i-=8,s[f++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function ks(e,t,r){let n=t[t.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function Hs(e){let t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function q({name:e,prefix:t,bitsPerChar:r,alphabet:n}){let o=Hs(n);return Yt({prefix:t,name:e,encode(s){return ks(s,n,r)},decode(s){return Os(s,o,r,e)}})}var F=vt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ms=vt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _r={};rt(_r,{base32:()=>Wt,base32hex:()=>Fs,base32hexpad:()=>Gs,base32hexpadupper:()=>Zs,base32hexupper:()=>js,base32pad:()=>Vs,base32padupper:()=>zs,base32upper:()=>qs,base32z:()=>Ys});var Wt=q({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qs=q({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vs=q({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zs=q({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fs=q({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),js=q({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Gs=q({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zs=q({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ys=q({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Lr={};rt(Lr,{base36:()=>pe,base36upper:()=>Ws});var pe=vt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ws=vt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $s=Mn,kn=128,Xs=127,Js=~Xs,Qs=Math.pow(2,31);function Mn(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Qs;)t[r++]=e&255|kn,e/=128;for(;e&Js;)t[r++]=e&255|kn,e>>>=7;return t[r]=e|0,Mn.bytes=r-n+1,t}var ti=Tr,ei=128,Hn=127;function Tr(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw Tr.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&Hn)<<o:(i&Hn)*Math.pow(2,o),o+=7}while(i>=ei);return Tr.bytes=s-n,r}var ri=Math.pow(2,7),ni=Math.pow(2,14),oi=Math.pow(2,21),si=Math.pow(2,28),ii=Math.pow(2,35),ai=Math.pow(2,42),ci=Math.pow(2,49),fi=Math.pow(2,56),ui=Math.pow(2,63),hi=function(e){return e<ri?1:e<ni?2:e<oi?3:e<si?4:e<ii?5:e<ai?6:e<ci?7:e<fi?8:e<ui?9:10},li={encode:$s,decode:ti,encodingLength:hi},di=li,me=di;function ye(e,t=0){return[me.decode(e,t),me.decode.bytes]}function $t(e,t,r=0){return me.encode(e,t,r),t}function Xt(e){return me.encodingLength(e)}function Rt(e,t){let r=t.byteLength,n=Xt(e),o=n+Xt(r),s=new Uint8Array(o+r);return $t(e,s,0),$t(r,s,n),s.set(t,o),new Jt(e,r,t,s)}function be(e){let t=xt(e),[r,n]=ye(t),[o,s]=ye(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Jt(r,o,i,t)}function qn(e,t){if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Un(e.bytes,r.bytes)}}var Jt=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function Vn(e,t){let{bytes:r,version:n}=e;switch(n){case 0:return mi(r,Dr(e),t??F.encoder);default:return yi(r,Dr(e),t??Wt.encoder)}}var zn=new WeakMap;function Dr(e){let t=zn.get(e);if(t==null){let r=new Map;return zn.set(e,r),r}return t}var J=class e{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==xe)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==bi)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Rt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n!=null&&t.code===n.code&&t.version===n.version&&qn(t.multihash,n.multihash)}toString(t){return Vn(this,t)}toJSON(){return{"/":Vn(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new e(n,o,s,i??Fn(n,o,s.bytes))}else if(r[xi]===!0){let{version:n,multihash:o,code:s}=r,i=be(o);return e.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==xe)throw new Error(`Version 0 CID must use dag-pb (code: ${xe}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=Fn(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,xe,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=xt(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Jt(r.multihashCode,r.digestSize,s,o);return[r.version===0?e.createV0(i):e.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,x]=ye(t.subarray(r));return r+=x,h},o=n(),s=xe;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),f=n(),l=r+f,c=l-i;return{version:o,codec:s,multihashCode:a,digestSize:f,multihashSize:c,size:l}}static parse(t,r){let[n,o]=pi(t,r),s=e.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Dr(s).set(n,t),s}};function pi(e,t){switch(e[0]){case"Q":{let r=t??F;return[F.prefix,r.decode(`${F.prefix}${e}`)]}case F.prefix:{let r=t??F;return[F.prefix,r.decode(e)]}case Wt.prefix:{let r=t??Wt;return[Wt.prefix,r.decode(e)]}case pe.prefix:{let r=t??pe;return[pe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function mi(e,t,r){let{prefix:n}=r;if(n!==F.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function yi(e,t,r){let{prefix:n}=r,o=t.get(n);if(o==null){let s=r.encode(e);return t.set(n,s),s}else return o}var xe=112,bi=18;function Fn(e,t,r){let n=Xt(e),o=n+Xt(t),s=new Uint8Array(o+r.byteLength);return $t(e,s,0),$t(t,s,n),s.set(r,o),s}var xi=Symbol.for("@ipld/js-cid/CID");var Cr={};rt(Cr,{identity:()=>ft});var jn=0,gi="identity",Gn=xt;function wi(e){return Rt(jn,Gn(e))}var ft={code:jn,name:gi,encode:Gn,digest:wi};function ut(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function gt(e=0){return new Uint8Array(e)}function nt(e=0){return new Uint8Array(e)}function Ge(e,t){t==null&&(t=e.reduce((o,s)=>o+s.length,0));let r=nt(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return r}var Yn=Symbol.for("@achingbrain/uint8arraylist");function Zn(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let o=r+n.byteLength;if(t<o)return{buf:n,index:t-r};r=o}throw new RangeError("index is out of bounds")}function Ze(e){return!!e?.[Yn]}var ot=class e{bufs;length;[Yn]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Ze(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Ze(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Zn(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Zn(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(Ze(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:o}=this._subList(t,r);return Ge(n,o)}subarray(t,r){let{bufs:n,length:o}=this._subList(t,r);return n.length===1?n[0]:Ge(n,o)}sublist(t,r){let{bufs:n,length:o}=this._subList(t,r),s=new e;return s.length=o,s.bufs=[...n],s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,f=a+i.byteLength;if(o=f,t>=f)continue;let l=t>=a&&t<f,c=r>a&&r<=f;if(l&&c){if(t===a&&r===f){n.push(i);break}let h=t-a;n.push(i.subarray(h,h+(r-t)));break}if(l){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(c){if(r===f){n.push(i);break}n.push(i.subarray(0,r-a));break}n.push(i)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!Ze(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let h=0;h<s;h++)i[h]=-1;for(let h=0;h<o;h++)i[n[h]]=h;let a=i,f=this.byteLength-n.byteLength,l=n.byteLength-1,c;for(let h=r;h<=f;h+=c){c=0;for(let x=l;x>=0;x--){let b=this.get(h+x);if(n[x]!==b){c=Math.max(1,x-a[b]);break}}if(c===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=nt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let o=gt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,r,n),this.write(o,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let o=gt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,r,n),this.write(o,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let o=gt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,r,n),this.write(o,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=nt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let o=gt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,r,n),this.write(o,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let o=gt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,r,n),this.write(o,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let o=gt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,r,n),this.write(o,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let o=gt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,r,n),this.write(o,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let o=gt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,r,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!ut(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((o,s)=>o+s.byteLength,0)),n.length=r,n}};var Ur={};rt(Ur,{base10:()=>Ei});var Ei=vt({prefix:"9",name:"base10",alphabet:"0123456789"});var Kr={};rt(Kr,{base16:()=>Si,base16upper:()=>Ai});var Si=q({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ai=q({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pr={};rt(Pr,{base2:()=>Bi});var Bi=q({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Rr={};rt(Rr,{base256emoji:()=>Ti});var Wn=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),vi=Wn.reduce((e,t,r)=>(e[r]=t,e),[]),Ii=Wn.reduce((e,t,r)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function _i(e){return e.reduce((t,r)=>(t+=vi[r],t),"")}function Li(e){let t=[];for(let r of e){let n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);let o=Ii[n];if(o==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(o)}return new Uint8Array(t)}var Ti=Yt({prefix:"\u{1F680}",name:"base256emoji",encode:_i,decode:Li});var Nr={};rt(Nr,{base64:()=>Di,base64pad:()=>Ci,base64url:()=>Ui,base64urlpad:()=>Ki});var Di=q({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ci=q({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ui=q({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ki=q({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Or={};rt(Or,{base8:()=>Pi});var Pi=q({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var kr={};rt(kr,{identity:()=>Ri});var Ri=Yt({prefix:"\0",name:"identity",encode:e=>Pn(e),decode:e=>Kn(e)});var Xc=new TextEncoder,Jc=new TextDecoder;var qr={};rt(qr,{sha256:()=>ge,sha512:()=>ki});function Mr({name:e,code:t,encode:r}){return new Hr(e,t,r)}var Hr=class{name;code;encode;constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Rt(this.code,r):r.then(n=>Rt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function Xn(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}var ge=Mr({name:"sha2-256",code:18,encode:Xn("SHA-256")}),ki=Mr({name:"sha2-512",code:19,encode:Xn("SHA-512")});var Vr={...kr,...Pr,...Or,...Ur,...Kr,..._r,...Lr,...Ir,...Nr,...Rr},hf={...qr,...Cr};function Qn(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Jn=Qn("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),zr=Qn("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=nt(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Hi={utf8:Jn,"utf-8":Jn,hex:Vr.base16,latin1:zr,ascii:zr,binary:zr,...Vr},Ye=Hi;function It(e,t="utf8"){let r=Ye[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function st(e,t="utf8"){let r=Ye[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var Mi=parseInt("11111",2),Fr=parseInt("10000000",2),qi=parseInt("01111111",2),to={0:we,1:we,2:Vi,3:ji,4:Gi,5:Fi,6:zi,16:we,22:we,48:we};function jr(e,t={offset:0}){let r=e[t.offset]&Mi;if(t.offset++,to[r]!=null)return to[r](e,t);throw new Error("No decoder for tag "+r)}function Ee(e,t){let r=0;if((e[t.offset]&Fr)===Fr){let n=e[t.offset]&qi,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=e[t.offset].toString(16).padStart(2,"0");r=parseInt(o,16)}else r=e[t.offset],t.offset++;return r}function we(e,t){Ee(e,t);let r=[];for(;!(t.offset>=e.byteLength);){let n=jr(e,t);if(n===null)break;r.push(n)}return r}function Vi(e,t){let r=Ee(e,t),n=t.offset,o=t.offset+r,s=[];for(let i=n;i<o;i++)i===n&&e[i]===0||s.push(e[i]);return t.offset+=r,Uint8Array.from(s)}function zi(e,t){let r=Ee(e,t),n=t.offset+r,o=e[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let a=`${s}.${i}`,f=[];for(;t.offset<n;){let l=e[t.offset];if(t.offset++,f.push(l&127),l<128){f.reverse();let c=0;for(let h=0;h<f.length;h++)c+=f[h]<<h*7;a+=`.${c}`,f=[]}}return a}function Fi(e,t){return t.offset++,null}function ji(e,t){let r=Ee(e,t),n=e[t.offset];t.offset++;let o=e.subarray(t.offset,t.offset+r-1);if(t.offset+=r,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function Gi(e,t){let r=Ee(e,t),n=e.subarray(t.offset,t.offset+r);return t.offset+=r,n}function Zi(e){let t=e.toString(16);t.length%2===1&&(t="0"+t);let r=new ot;for(let n=0;n<t.length;n+=2)r.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return r}function Gr(e){if(e.byteLength<128)return Uint8Array.from([e.byteLength]);let t=Zi(e.byteLength);return new ot(Uint8Array.from([t.byteLength|Fr]),t)}function eo(e){let t=new ot,r=128;return(e.subarray()[0]&r)===r&&t.append(Uint8Array.from([0])),t.append(e),new ot(Uint8Array.from([2]),Gr(t),t)}function ro(e){let t=Uint8Array.from([0]),r=new ot(t,e);return new ot(Uint8Array.from([3]),Gr(r),r)}function We(e,t=48){let r=new ot;for(let n of e)r.append(n);return new ot(Uint8Array.from([t]),Gr(r),r)}async function no(e,t,r,n){let o=await crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:e.crv??"P-256"},!1,["verify"]);n?.signal?.throwIfAborted();let s=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},o,t,r.subarray());return n?.signal?.throwIfAborted(),s}var Yi=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),Wi=Uint8Array.from([6,5,43,129,4,0,34]),$i=Uint8Array.from([6,5,43,129,4,0,35]),Xi={ext:!0,kty:"EC",crv:"P-256"},Ji={ext:!0,kty:"EC",crv:"P-384"},Qi={ext:!0,kty:"EC",crv:"P-521"},Zr=32,Yr=48,Wr=66;function oo(e){let t=jr(e);return so(t)}function so(e){let t=e[1][1][0],r=1,n,o;if(t.byteLength===Zr*2+1)return n=st(t.subarray(r,r+Zr),"base64url"),o=st(t.subarray(r+Zr),"base64url"),new te({...Xi,key_ops:["verify"],x:n,y:o});if(t.byteLength===Yr*2+1)return n=st(t.subarray(r,r+Yr),"base64url"),o=st(t.subarray(r+Yr),"base64url"),new te({...Ji,key_ops:["verify"],x:n,y:o});if(t.byteLength===Wr*2+1)return n=st(t.subarray(r,r+Wr),"base64url"),o=st(t.subarray(r+Wr),"base64url"),new te({...Qi,key_ops:["verify"],x:n,y:o});throw new pt(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function io(e){return We([eo(Uint8Array.from([1])),We([ta(e.crv)],160),We([ro(new ot(Uint8Array.from([4]),It(e.x??"","base64url"),It(e.y??"","base64url")))],161)]).subarray()}function ta(e){if(e==="P-256")return Yi;if(e==="P-384")return Wi;if(e==="P-521")return $i;throw new pt(`Invalid curve ${e}`)}var te=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=io(this.jwk)),this._raw}toMultihash(){return ft.digest(ee(this))}toCID(){return J.createV1(114,this.toMultihash())}toString(){return F.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}async verify(t,r,n){return no(this.jwk,r,t,n)}};var Nt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ne(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Se(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function W(e,...t){if(!ne(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function co(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Se(e.outputLen),Se(e.blockLen)}function oe(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function fo(e,t){W(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Et(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function $e(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ht(e,t){return e<<32-t|e>>>t}var uo=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ea=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function mt(e){if(W(e),uo)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=ea[e[r]];return t}var wt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ao(e){if(e>=wt._0&&e<=wt._9)return e-wt._0;if(e>=wt.A&&e<=wt.F)return e-(wt.A-10);if(e>=wt.a&&e<=wt.f)return e-(wt.a-10)}function se(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(uo)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let i=ao(e.charCodeAt(s)),a=ao(e.charCodeAt(s+1));if(i===void 0||a===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}n[o]=i*16+a}return n}function ho(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Ae(e){return typeof e=="string"&&(e=ho(e)),W(e),e}function it(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];W(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let s=e[n];r.set(s,o),o+=s.length}return r}var re=class{};function $r(e){let t=n=>e().update(Ae(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Be(e=32){if(Nt&&typeof Nt.getRandomValues=="function")return Nt.getRandomValues(new Uint8Array(e));if(Nt&&typeof Nt.randomBytes=="function")return Uint8Array.from(Nt.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function ra(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),a=Number(r&s),f=n?4:0,l=n?0:4;e.setUint32(t+f,i,n),e.setUint32(t+l,a,n)}function lo(e,t,r){return e&t^~e&r}function po(e,t,r){return e&t^e&r^t&r}var ve=class extends re{constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=$e(this.buffer)}update(t){oe(this),t=Ae(t),W(t);let{view:r,buffer:n,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let f=$e(t);for(;o<=s-i;i+=o)this.process(f,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){oe(this),fo(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;r[i++]=128,Et(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(n,0),i=0);for(let h=i;h<o;h++)r[h]=0;ra(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=$e(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=f/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,c[h],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=a,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},St=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var Z=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var Xe=BigInt(4294967295),mo=BigInt(32);function na(e,t=!1){return t?{h:Number(e&Xe),l:Number(e>>mo&Xe)}:{h:Number(e>>mo&Xe)|0,l:Number(e&Xe)|0}}function yo(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let s=0;s<r;s++){let{h:i,l:a}=na(e[s],t);[n[s],o[s]]=[i,a]}return[n,o]}var Xr=(e,t,r)=>e>>>r,Jr=(e,t,r)=>e<<32-r|t>>>r,Ot=(e,t,r)=>e>>>r|t<<32-r,kt=(e,t,r)=>e<<32-r|t>>>r,Ie=(e,t,r)=>e<<64-r|t>>>r-32,_e=(e,t,r)=>e>>>r-32|t<<64-r;function yt(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var bo=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),xo=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,go=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),wo=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,Eo=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),So=(e,t,r,n,o,s)=>t+r+n+o+s+(e/2**32|0)|0;var sa=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_t=new Uint32Array(64),Qr=class extends ve{constructor(t=32){super(64,t,8,!1),this.A=St[0]|0,this.B=St[1]|0,this.C=St[2]|0,this.D=St[3]|0,this.E=St[4]|0,this.F=St[5]|0,this.G=St[6]|0,this.H=St[7]|0}get(){let{A:t,B:r,C:n,D:o,E:s,F:i,G:a,H:f}=this;return[t,r,n,o,s,i,a,f]}set(t,r,n,o,s,i,a,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=f|0}process(t,r){for(let h=0;h<16;h++,r+=4)_t[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let x=_t[h-15],b=_t[h-2],S=ht(x,7)^ht(x,18)^x>>>3,E=ht(b,17)^ht(b,19)^b>>>10;_t[h]=E+_t[h-7]+S+_t[h-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:f,G:l,H:c}=this;for(let h=0;h<64;h++){let x=ht(a,6)^ht(a,11)^ht(a,25),b=c+x+lo(a,f,l)+sa[h]+_t[h]|0,E=(ht(n,2)^ht(n,13)^ht(n,22))+po(n,o,s)|0;c=l,l=f,f=a,a=i+b|0,i=s,s=o,o=n,n=b+E|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,f=f+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,o,s,i,a,f,l,c)}roundClean(){Et(_t)}destroy(){this.set(0,0,0,0,0,0,0,0),Et(this.buffer)}};var Ao=yo(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ia=Ao[0],aa=Ao[1],Lt=new Uint32Array(80),Tt=new Uint32Array(80),tn=class extends ve{constructor(t=64){super(128,t,16,!1),this.Ah=Z[0]|0,this.Al=Z[1]|0,this.Bh=Z[2]|0,this.Bl=Z[3]|0,this.Ch=Z[4]|0,this.Cl=Z[5]|0,this.Dh=Z[6]|0,this.Dl=Z[7]|0,this.Eh=Z[8]|0,this.El=Z[9]|0,this.Fh=Z[10]|0,this.Fl=Z[11]|0,this.Gh=Z[12]|0,this.Gl=Z[13]|0,this.Hh=Z[14]|0,this.Hl=Z[15]|0}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:f,Eh:l,El:c,Fh:h,Fl:x,Gh:b,Gl:S,Hh:E,Hl:m}=this;return[t,r,n,o,s,i,a,f,l,c,h,x,b,S,E,m]}set(t,r,n,o,s,i,a,f,l,c,h,x,b,S,E,m){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=f|0,this.Eh=l|0,this.El=c|0,this.Fh=h|0,this.Fl=x|0,this.Gh=b|0,this.Gl=S|0,this.Hh=E|0,this.Hl=m|0}process(t,r){for(let v=0;v<16;v++,r+=4)Lt[v]=t.getUint32(r),Tt[v]=t.getUint32(r+=4);for(let v=16;v<80;v++){let U=Lt[v-15]|0,p=Tt[v-15]|0,C=Ot(U,p,1)^Ot(U,p,8)^Xr(U,p,7),D=kt(U,p,1)^kt(U,p,8)^Jr(U,p,7),I=Lt[v-2]|0,u=Tt[v-2]|0,g=Ot(I,u,19)^Ie(I,u,61)^Xr(I,u,6),d=kt(I,u,19)^_e(I,u,61)^Jr(I,u,6),y=go(D,d,Tt[v-7],Tt[v-16]),w=wo(y,C,g,Lt[v-7],Lt[v-16]);Lt[v]=w|0,Tt[v]=y|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:f,Dh:l,Dl:c,Eh:h,El:x,Fh:b,Fl:S,Gh:E,Gl:m,Hh:A,Hl:T}=this;for(let v=0;v<80;v++){let U=Ot(h,x,14)^Ot(h,x,18)^Ie(h,x,41),p=kt(h,x,14)^kt(h,x,18)^_e(h,x,41),C=h&b^~h&E,D=x&S^~x&m,I=Eo(T,p,D,aa[v],Tt[v]),u=So(I,A,U,C,ia[v],Lt[v]),g=I|0,d=Ot(n,o,28)^Ie(n,o,34)^Ie(n,o,39),y=kt(n,o,28)^_e(n,o,34)^_e(n,o,39),w=n&s^n&a^s&a,_=o&i^o&f^i&f;A=E|0,T=m|0,E=b|0,m=S|0,b=h|0,S=x|0,{h,l:x}=yt(l|0,c|0,u|0,g|0),l=a|0,c=f|0,a=s|0,f=i|0,s=n|0,i=o|0;let B=bo(g,y,_);n=xo(B,u,d,w),o=B|0}({h:n,l:o}=yt(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=yt(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:f}=yt(this.Ch|0,this.Cl|0,a|0,f|0),{h:l,l:c}=yt(this.Dh|0,this.Dl|0,l|0,c|0),{h,l:x}=yt(this.Eh|0,this.El|0,h|0,x|0),{h:b,l:S}=yt(this.Fh|0,this.Fl|0,b|0,S|0),{h:E,l:m}=yt(this.Gh|0,this.Gl|0,E|0,m|0),{h:A,l:T}=yt(this.Hh|0,this.Hl|0,A|0,T|0),this.set(n,o,s,i,a,f,l,c,h,x,b,S,E,m,A,T)}roundClean(){Et(Lt,Tt)}destroy(){Et(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Bo=$r(()=>new Qr);var vo=$r(()=>new tn);var nn=BigInt(0),rn=BigInt(1);function At(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function Le(e){let t=e.toString(16);return t.length&1?"0"+t:t}function Io(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?nn:BigInt("0x"+e)}function ie(e){return Io(mt(e))}function Ht(e){return W(e),Io(mt(Uint8Array.from(e).reverse()))}function Je(e,t){return se(e.toString(16).padStart(t*2,"0"))}function ae(e,t){return Je(e,t).reverse()}function k(e,t,r){let n;if(typeof t=="string")try{n=se(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(ne(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}var en=e=>typeof e=="bigint"&&nn<=e;function _o(e,t,r){return en(e)&&en(t)&&en(r)&&t<=e&&e<r}function Dt(e,t,r,n){if(!_o(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function Lo(e){let t;for(t=0;e>nn;e>>=rn,t+=1);return t}var Mt=e=>(rn<<BigInt(e))-rn;function To(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=b=>new Uint8Array(b),o=b=>Uint8Array.of(b),s=n(e),i=n(e),a=0,f=()=>{s.fill(1),i.fill(0),a=0},l=(...b)=>r(i,s,...b),c=(b=n(0))=>{i=l(o(0),b),s=l(),b.length!==0&&(i=l(o(1),b),s=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let b=0,S=[];for(;b<t;){s=l();let E=s.slice();S.push(E),b+=s.length}return it(...S)};return(b,S)=>{f(),c(b);let E;for(;!(E=S(h()));)c();return f(),E}}function Ct(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(o,s,i){let a=e[o];if(i&&a===void 0)return;let f=typeof a;if(f!==s||a===null)throw new Error(`param "${o}" is invalid: expected ${s}, got ${f}`)}Object.entries(t).forEach(([o,s])=>n(o,s,!1)),Object.entries(r).forEach(([o,s])=>n(o,s,!0))}function ce(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let s=e(r,...n);return t.set(r,s),s}}var Q=BigInt(0),G=BigInt(1),qt=BigInt(2),ca=BigInt(3),Uo=BigInt(4),Ko=BigInt(5),Po=BigInt(8);function M(e,t){let r=e%t;return r>=Q?r:t+r}function H(e,t,r){let n=e;for(;t-- >Q;)n*=n,n%=r;return n}function Do(e,t){if(e===Q)throw new Error("invert: expected non-zero number");if(t<=Q)throw new Error("invert: expected positive modulus, got "+t);let r=M(e,t),n=t,o=Q,s=G,i=G,a=Q;for(;r!==Q;){let l=n/r,c=n%r,h=o-i*l,x=s-a*l;n=r,r=c,o=i,s=a,i=h,a=x}if(n!==G)throw new Error("invert: does not exist");return M(o,t)}function Ro(e,t){let r=(e.ORDER+G)/Uo,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function fa(e,t){let r=(e.ORDER-Ko)/Po,n=e.mul(t,qt),o=e.pow(n,r),s=e.mul(t,o),i=e.mul(e.mul(s,qt),o),a=e.mul(s,e.sub(i,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function ua(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-G,r=0;for(;t%qt===Q;)t/=qt,r++;let n=qt,o=lt(e);for(;Co(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Ro;let s=o.pow(n,t),i=(t+G)/qt;return function(f,l){if(f.is0(l))return l;if(Co(f,l)!==1)throw new Error("Cannot find square root");let c=r,h=f.mul(f.ONE,s),x=f.pow(l,t),b=f.pow(l,i);for(;!f.eql(x,f.ONE);){if(f.is0(x))return f.ZERO;let S=1,E=f.sqr(x);for(;!f.eql(E,f.ONE);)if(S++,E=f.sqr(E),S===c)throw new Error("Cannot find square root");let m=G<<BigInt(c-S-1),A=f.pow(h,m);c=S,h=f.sqr(A),x=f.mul(x,h),b=f.mul(b,A)}return b}}function ha(e){return e%Uo===ca?Ro:e%Po===Ko?fa:ua(e)}var No=(e,t)=>(M(e,t)&G)===G,la=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function on(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=la.reduce((n,o)=>(n[o]="function",n),t);return Ct(e,r),e}function da(e,t,r){if(r<Q)throw new Error("invalid exponent, negatives unsupported");if(r===Q)return e.ONE;if(r===G)return t;let n=e.ONE,o=t;for(;r>Q;)r&G&&(n=e.mul(n,o)),o=e.sqr(o),r>>=G;return n}function Te(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((i,a,f)=>e.is0(a)?i:(n[f]=i,e.mul(i,a)),e.ONE),s=e.inv(o);return t.reduceRight((i,a,f)=>e.is0(a)?i:(n[f]=e.mul(i,n[f]),e.mul(i,a)),s),n}function Co(e,t){let r=(e.ORDER-G)/qt,n=e.pow(t,r),o=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),i=e.eql(n,e.neg(e.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function Oo(e,t){t!==void 0&&Se(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function lt(e,t,r=!1,n={}){if(e<=Q)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,s;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");let c=t;c.BITS&&(o=c.BITS),c.sqrt&&(s=c.sqrt),typeof c.isLE=="boolean"&&(r=c.isLE)}else typeof t=="number"&&(o=t),n.sqrt&&(s=n.sqrt);let{nBitLength:i,nByteLength:a}=Oo(e,o);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f,l=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:a,MASK:Mt(i),ZERO:Q,ONE:G,create:c=>M(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Q<=c&&c<e},is0:c=>c===Q,isValidNot0:c=>!l.is0(c)&&l.isValid(c),isOdd:c=>(c&G)===G,neg:c=>M(-c,e),eql:(c,h)=>c===h,sqr:c=>M(c*c,e),add:(c,h)=>M(c+h,e),sub:(c,h)=>M(c-h,e),mul:(c,h)=>M(c*h,e),pow:(c,h)=>da(l,c,h),div:(c,h)=>M(c*Do(h,e),e),sqrN:c=>c*c,addN:(c,h)=>c+h,subN:(c,h)=>c-h,mulN:(c,h)=>c*h,inv:c=>Do(c,e),sqrt:s||(c=>(f||(f=ha(e)),f(l,c))),toBytes:c=>r?ae(c,a):Je(c,a),fromBytes:c=>{if(c.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+c.length);return r?Ht(c):ie(c)},invertBatch:c=>Te(l,c),cmov:(c,h,x)=>x?h:c});return Object.freeze(l)}function ko(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function sn(e){let t=ko(e);return t+Math.ceil(t/2)}function Ho(e,t,r=!1){let n=e.length,o=ko(t),s=sn(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=r?Ht(e):ie(e),a=M(i,t-G)+G;return r?ae(a,o):Je(a,o)}var ue=BigInt(0),Vt=BigInt(1);function fe(e,t){let r=t.negate();return e?r:t}function Qe(e,t,r){let n=t==="pz"?i=>i.pz:i=>i.ez,o=Te(e.Fp,r.map(n));return r.map((i,a)=>i.toAffine(o[a])).map(e.fromAffine)}function zo(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function an(e,t){zo(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,s=Mt(e),i=BigInt(e);return{windows:r,windowSize:n,mask:s,maxNumber:o,shiftBy:i}}function Mo(e,t,r){let{windowSize:n,mask:o,maxNumber:s,shiftBy:i}=r,a=Number(e&o),f=e>>i;a>n&&(a-=s,f+=Vt);let l=t*n,c=l+Math.abs(a)-1,h=a===0,x=a<0,b=t%2!==0;return{nextN:f,offset:c,isZero:h,isNeg:x,isNegF:b,offsetF:l}}function pa(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function ma(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}var cn=new WeakMap,Fo=new WeakMap;function fn(e){return Fo.get(e)||1}function qo(e){if(e!==ue)throw new Error("invalid wNAF")}function tr(e,t){return{constTimeNegate:fe,hasPrecomputes(r){return fn(r)!==1},unsafeLadder(r,n,o=e.ZERO){let s=r;for(;n>ue;)n&Vt&&(o=o.add(s)),s=s.double(),n>>=Vt;return o},precomputeWindow(r,n){let{windows:o,windowSize:s}=an(n,t),i=[],a=r,f=a;for(let l=0;l<o;l++){f=a,i.push(f);for(let c=1;c<s;c++)f=f.add(a),i.push(f);a=f.double()}return i},wNAF(r,n,o){let s=e.ZERO,i=e.BASE,a=an(r,t);for(let f=0;f<a.windows;f++){let{nextN:l,offset:c,isZero:h,isNeg:x,isNegF:b,offsetF:S}=Mo(o,f,a);o=l,h?i=i.add(fe(b,n[S])):s=s.add(fe(x,n[c]))}return qo(o),{p:s,f:i}},wNAFUnsafe(r,n,o,s=e.ZERO){let i=an(r,t);for(let a=0;a<i.windows&&o!==ue;a++){let{nextN:f,offset:l,isZero:c,isNeg:h}=Mo(o,a,i);if(o=f,!c){let x=n[l];s=s.add(h?x.negate():x)}}return qo(o),s},getPrecomputes(r,n,o){let s=cn.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&(typeof o=="function"&&(s=o(s)),cn.set(n,s))),s},wNAFCached(r,n,o){let s=fn(r);return this.wNAF(s,this.getPrecomputes(s,r,o),n)},wNAFCachedUnsafe(r,n,o,s){let i=fn(r);return i===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,r,o),n,s)},setWindowSize(r,n){zo(n,t),Fo.set(r,n),cn.delete(r)}}}function jo(e,t,r,n){let o=t,s=e.ZERO,i=e.ZERO;for(;r>ue||n>ue;)r&Vt&&(s=s.add(o)),n&Vt&&(i=i.add(o)),o=o.double(),r>>=Vt,n>>=Vt;return{p1:s,p2:i}}function er(e,t,r,n){pa(r,e),ma(n,t);let o=r.length,s=n.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");let i=e.ZERO,a=Lo(BigInt(o)),f=1;a>12?f=a-3:a>4?f=a-2:a>0&&(f=2);let l=Mt(f),c=new Array(Number(l)+1).fill(i),h=Math.floor((t.BITS-1)/f)*f,x=i;for(let b=h;b>=0;b-=f){c.fill(i);for(let E=0;E<s;E++){let m=n[E],A=Number(m>>BigInt(b)&l);c[A]=c[A].add(r[E])}let S=i;for(let E=c.length-1,m=i;E>0;E--)m=m.add(c[E]),S=S.add(m);if(x=x.add(S),b!==0)for(let E=0;E<f;E++)x=x.double()}return x}function Vo(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return on(t),t}else return lt(e)}function rr(e,t,r={}){if(!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let a of["p","n","h"]){let f=t[a];if(!(typeof f=="bigint"&&f>ue))throw new Error(`CURVE.${a} must be positive bigint`)}let n=Vo(t.p,r.Fp),o=Vo(t.n,r.Fn),i=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let a of i)if(!n.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:o}}var bt=BigInt(0),tt=BigInt(1),un=BigInt(2),ya=BigInt(8),ba={zip215:!0};function xa(e,t,r,n){let o=e.sqr(r),s=e.sqr(n),i=e.add(e.mul(t.a,o),s),a=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(i,a)}function ga(e,t={}){let{Fp:r,Fn:n}=rr("edwards",e,t),{h:o,n:s}=e;Ct(t,{},{uvRatio:"function"});let i=un<<BigInt(n.BYTES*8)-tt,a=E=>r.create(E),f=t.uvRatio||((E,m)=>{try{return{isValid:!0,value:r.sqrt(r.div(E,m))}}catch{return{isValid:!1,value:bt}}});if(!xa(r,e,e.Gx,e.Gy))throw new Error("bad curve params: generator point");function l(E,m,A=!1){let T=A?tt:bt;return Dt("coordinate "+E,m,T,i),m}function c(E){if(!(E instanceof b))throw new Error("ExtendedPoint expected")}let h=ce((E,m)=>{let{ex:A,ey:T,ez:v}=E,U=E.is0();m==null&&(m=U?ya:r.inv(v));let p=a(A*m),C=a(T*m),D=a(v*m);if(U)return{x:bt,y:tt};if(D!==tt)throw new Error("invZ was invalid");return{x:p,y:C}}),x=ce(E=>{let{a:m,d:A}=e;if(E.is0())throw new Error("bad point: ZERO");let{ex:T,ey:v,ez:U,et:p}=E,C=a(T*T),D=a(v*v),I=a(U*U),u=a(I*I),g=a(C*m),d=a(I*a(g+D)),y=a(u+a(A*a(C*D)));if(d!==y)throw new Error("bad point: equation left != right (1)");let w=a(T*v),_=a(U*p);if(w!==_)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(m,A,T,v){this.ex=l("x",m),this.ey=l("y",A),this.ez=l("z",T,!0),this.et=l("t",v),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(m){if(m instanceof b)throw new Error("extended point not allowed");let{x:A,y:T}=m||{};return l("x",A),l("y",T),new b(A,T,tt,a(A*T))}static normalizeZ(m){return Qe(b,"ez",m)}static msm(m,A){return er(b,n,m,A)}_setWindowSize(m){this.precompute(m)}precompute(m=8,A=!0){return S.setWindowSize(this,m),A||this.multiply(un),this}assertValidity(){x(this)}equals(m){c(m);let{ex:A,ey:T,ez:v}=this,{ex:U,ey:p,ez:C}=m,D=a(A*C),I=a(U*v),u=a(T*C),g=a(p*v);return D===I&&u===g}is0(){return this.equals(b.ZERO)}negate(){return new b(a(-this.ex),this.ey,this.ez,a(-this.et))}double(){let{a:m}=e,{ex:A,ey:T,ez:v}=this,U=a(A*A),p=a(T*T),C=a(un*a(v*v)),D=a(m*U),I=A+T,u=a(a(I*I)-U-p),g=D+p,d=g-C,y=D-p,w=a(u*d),_=a(g*y),B=a(u*y),L=a(d*g);return new b(w,_,L,B)}add(m){c(m);let{a:A,d:T}=e,{ex:v,ey:U,ez:p,et:C}=this,{ex:D,ey:I,ez:u,et:g}=m,d=a(v*D),y=a(U*I),w=a(C*T*g),_=a(p*u),B=a((v+U)*(D+I)-d-y),L=_-w,P=_+w,K=a(y-A*d),V=a(B*L),N=a(P*K),R=a(B*K),z=a(L*P);return new b(V,N,z,R)}subtract(m){return this.add(m.negate())}multiply(m){let A=m;Dt("scalar",A,tt,s);let{p:T,f:v}=S.wNAFCached(this,A,b.normalizeZ);return b.normalizeZ([T,v])[0]}multiplyUnsafe(m,A=b.ZERO){let T=m;return Dt("scalar",T,bt,s),T===bt?b.ZERO:this.is0()||T===tt?this:S.wNAFCachedUnsafe(this,T,b.normalizeZ,A)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}isTorsionFree(){return S.wNAFCachedUnsafe(this,s).is0()}toAffine(m){return h(this,m)}clearCofactor(){return o===tt?this:this.multiplyUnsafe(o)}static fromBytes(m,A=!1){return W(m),this.fromHex(m,A)}static fromHex(m,A=!1){let{d:T,a:v}=e,U=r.BYTES;m=k("pointHex",m,U),At("zip215",A);let p=m.slice(),C=m[U-1];p[U-1]=C&-129;let D=Ht(p),I=A?i:r.ORDER;Dt("pointHex.y",D,bt,I);let u=a(D*D),g=a(u-tt),d=a(T*u-v),{isValid:y,value:w}=f(g,d);if(!y)throw new Error("Point.fromHex: invalid y coordinate");let _=(w&tt)===tt,B=(C&128)!==0;if(!A&&w===bt&&B)throw new Error("Point.fromHex: x=0 and x_0=1");return B!==_&&(w=a(-w)),b.fromAffine({x:w,y:D})}static fromPrivateScalar(m){return b.BASE.multiply(m)}toBytes(){let{x:m,y:A}=this.toAffine(),T=ae(A,r.BYTES);return T[T.length-1]|=m&tt?128:0,T}toRawBytes(){return this.toBytes()}toHex(){return mt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}b.BASE=new b(e.Gx,e.Gy,tt,a(e.Gx*e.Gy)),b.ZERO=new b(bt,tt,tt,bt),b.Fp=r,b.Fn=n;let S=tr(b,n.BYTES*8);return b}function wa(e,t){Ct(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r,hash:n}=t,{BASE:o,Fp:s,Fn:i}=e,a=i.ORDER,f=t.randomBytes||Be,l=t.adjustScalarBytes||(p=>p),c=t.domain||((p,C,D)=>{if(At("phflag",D),C.length||D)throw new Error("Contexts/pre-hash are not supported");return p});function h(p){return i.create(p)}function x(p){return h(Ht(p))}function b(p){let C=s.BYTES;p=k("private key",p,C);let D=k("hashed private key",n(p),2*C),I=l(D.slice(0,C)),u=D.slice(C,2*C),g=x(I);return{head:I,prefix:u,scalar:g}}function S(p){let{head:C,prefix:D,scalar:I}=b(p),u=o.multiply(I),g=u.toBytes();return{head:C,prefix:D,scalar:I,point:u,pointBytes:g}}function E(p){return S(p).pointBytes}function m(p=Uint8Array.of(),...C){let D=it(...C);return x(n(c(D,k("context",p),!!r)))}function A(p,C,D={}){p=k("message",p),r&&(p=r(p));let{prefix:I,scalar:u,pointBytes:g}=S(C),d=m(D.context,I,p),y=o.multiply(d).toBytes(),w=m(D.context,y,g,p),_=h(d+w*u);Dt("signature.s",_,bt,a);let B=s.BYTES,L=it(y,ae(_,B));return k("result",L,B*2)}let T=ba;function v(p,C,D,I=T){let{context:u,zip215:g}=I,d=s.BYTES;p=k("signature",p,2*d),C=k("message",C),D=k("publicKey",D,d),g!==void 0&&At("zip215",g),r&&(C=r(C));let y=Ht(p.slice(d,2*d)),w,_,B;try{w=e.fromHex(D,g),_=e.fromHex(p.slice(0,d),g),B=o.multiplyUnsafe(y)}catch{return!1}if(!g&&w.isSmallOrder())return!1;let L=m(u,_.toBytes(),w.toBytes(),C);return _.add(w.multiplyUnsafe(L)).subtract(B).clearCofactor().is0()}return o.precompute(8),{getPublicKey:E,sign:A,verify:v,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>f(s.BYTES),precompute(p=8,C=e.BASE){return C.precompute(p,!1)}},Point:e}}function Ea(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=lt(t.n,e.nBitLength,!0),o={Fp:r,Fn:n,uvRatio:e.uvRatio},s={hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,eddsaOpts:s}}function Sa(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}function Go(e){let{CURVE:t,curveOpts:r,eddsaOpts:n}=Ea(e),o=ga(t,r),s=wa(o,n);return Sa(e,s)}var yu=BigInt(0),Aa=BigInt(1),Zo=BigInt(2),bu=BigInt(3),Ba=BigInt(5),va=BigInt(8),nr={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:va,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Ia(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),s=nr.p,a=e*e%s*e%s,f=H(a,Zo,s)*a%s,l=H(f,Aa,s)*e%s,c=H(l,Ba,s)*l%s,h=H(c,t,s)*c%s,x=H(h,r,s)*h%s,b=H(x,n,s)*x%s,S=H(b,o,s)*b%s,E=H(S,o,s)*b%s,m=H(E,t,s)*c%s;return{pow_p_5_8:H(m,Zo,s)*e%s,b2:a}}function _a(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var Yo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function La(e,t){let r=nr.p,n=M(t*t*t,r),o=M(n*n*t,r),s=Ia(e*o).pow_p_5_8,i=M(e*n*s,r),a=M(t*i*i,r),f=i,l=M(i*Yo,r),c=a===e,h=a===M(-e,r),x=a===M(-e*Yo,r);return c&&(i=f),(h||x)&&(i=l),No(i,r)&&(i=M(-i,r)),{isValid:c||h,value:i}}var Ta=lt(nr.p,void 0,!0),Da={...nr,Fp:Ta,hash:vo,adjustScalarBytes:_a,uvRatio:La},Wo=Go(Da);var De=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},or=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var $o={get(e=globalThis){let t=e.crypto;if(t?.subtle==null)throw new or("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var sr=$o;var ir=32;var hn,Ca=(async()=>{try{return await sr.get().subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),!0}catch{return!1}})();async function Ua(e,t,r){if(e.buffer instanceof ArrayBuffer){let n=await sr.get().subtle.importKey("raw",e.buffer,{name:"Ed25519"},!1,["verify"]);return await sr.get().subtle.verify({name:"Ed25519"},n,t,r instanceof Uint8Array?r:r.subarray())}throw new TypeError("WebCrypto does not support SharedArrayBuffer for Ed25519 keys")}function Ka(e,t,r){return Wo.verify(t,r instanceof Uint8Array?r:r.subarray(),e)}async function Xo(e,t,r){return hn==null&&(hn=await Ca),hn?Ua(e,t,r):Ka(e,t,r)}function ar(e){return e==null?!1:typeof e.then=="function"&&typeof e.catch=="function"&&typeof e.finally=="function"}var cr=class{type="Ed25519";raw;constructor(t){this.raw=ln(t,ir)}toMultihash(){return ft.digest(ee(this))}toCID(){return J.createV1(114,this.toMultihash())}toString(){return F.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}verify(t,r,n){n?.signal?.throwIfAborted();let o=Xo(this.raw,r,t);return ar(o)?o.then(s=>(n?.signal?.throwIfAborted(),s)):o}};function Qo(e){return e=ln(e,ir),new cr(e)}function ln(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new pt(`Key must be a Uint8Array of length ${t}, got ${e.length}`);return e}var Ra=Math.pow(2,7),Na=Math.pow(2,14),Oa=Math.pow(2,21),ts=Math.pow(2,28),es=Math.pow(2,35),rs=Math.pow(2,42),ns=Math.pow(2,49),et=128,Ut=127;function Ce(e){if(e<Ra)return 1;if(e<Na)return 2;if(e<Oa)return 3;if(e<ts)return 4;if(e<es)return 5;if(e<rs)return 6;if(e<ns)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function os(e,t,r=0){switch(Ce(e)){case 8:t[r++]=e&255|et,e/=128;case 7:t[r++]=e&255|et,e/=128;case 6:t[r++]=e&255|et,e/=128;case 5:t[r++]=e&255|et,e/=128;case 4:t[r++]=e&255|et,e>>>=7;case 3:t[r++]=e&255|et,e>>>=7;case 2:t[r++]=e&255|et,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function ss(e,t){let r=e[t],n=0;if(n+=r&Ut,r<et||(r=e[t+1],n+=(r&Ut)<<7,r<et)||(r=e[t+2],n+=(r&Ut)<<14,r<et)||(r=e[t+3],n+=(r&Ut)<<21,r<et)||(r=e[t+4],n+=(r&Ut)*ts,r<et)||(r=e[t+5],n+=(r&Ut)*es,r<et)||(r=e[t+6],n+=(r&Ut)*rs,r<et)||(r=e[t+7],n+=(r&Ut)*ns,r<et))return n;throw new RangeError("Could not decode varint")}var dn=new Float32Array([-0]),Kt=new Uint8Array(dn.buffer);function is(e,t,r){dn[0]=e,t[r]=Kt[0],t[r+1]=Kt[1],t[r+2]=Kt[2],t[r+3]=Kt[3]}function as(e,t){return Kt[0]=e[t],Kt[1]=e[t+1],Kt[2]=e[t+2],Kt[3]=e[t+3],dn[0]}var pn=new Float64Array([-0]),$=new Uint8Array(pn.buffer);function cs(e,t,r){pn[0]=e,t[r]=$[0],t[r+1]=$[1],t[r+2]=$[2],t[r+3]=$[3],t[r+4]=$[4],t[r+5]=$[5],t[r+6]=$[6],t[r+7]=$[7]}function fs(e,t){return $[0]=e[t],$[1]=e[t+1],$[2]=e[t+2],$[3]=e[t+3],$[4]=e[t+4],$[5]=e[t+5],$[6]=e[t+6],$[7]=e[t+7],pn[0]}var ka=BigInt(Number.MAX_SAFE_INTEGER),Ha=BigInt(Number.MIN_SAFE_INTEGER),at=class e{lo;hi;constructor(t,r){this.lo=t|0,this.hi=r|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return zt;if(t<ka&&t>Ha)return this.fromNumber(Number(t));let r=t<0n;r&&(t=-t);let n=t>>32n,o=t-(n<<32n);return r&&(n=~n|0n,o=~o|0n,++o>us&&(o=0n,++n>us&&(n=0n))),new e(Number(o),Number(n))}static fromNumber(t){if(t===0)return zt;let r=t<0;r&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new e(n,o)}static from(t){return typeof t=="number"?e.fromNumber(t):typeof t=="bigint"?e.fromBigInt(t):typeof t=="string"?e.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new e(t.low>>>0,t.high>>>0):zt}},zt=new at(0,0);zt.toBigInt=function(){return 0n};zt.zzEncode=zt.zzDecode=function(){return this};zt.length=function(){return 1};var us=4294967296n;function hs(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function ls(e,t,r){if(r-t<1)return"";let o,s=[],i=0,a;for(;t<r;)a=e[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function mn(e,t,r){let n=r,o,s;for(let i=0;i<e.length;++i)o=e.charCodeAt(i),o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128);return r-n}function dt(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function fr(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}var yn=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,dt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw dt(this,4);return fr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw dt(this,4);return fr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw dt(this,4);let t=as(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw dt(this,4);let t=fs(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw dt(this,t);return this.pos+=t,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let t=this.bytes();return ls(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw dt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw dt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new at(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw dt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,t}if(this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw dt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw dt(this,8);let t=fr(this.buf,this.pos+=4),r=fr(this.buf,this.pos+=4);return new at(t,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=ss(this.buf,this.pos);return this.pos+=Ce(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function bn(e){return new yn(e instanceof Uint8Array?e:e.subarray())}function ur(e,t,r){let n=bn(e);return t.decode(n,void 0,r)}function xn(e){let t=e??8192,r=t>>>1,n,o=t;return function(i){if(i<1||i>r)return nt(i);o+i>t&&(n=nt(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var Ft=class{fn;len;next;val;constructor(t,r,n){this.fn=t,this.len=r,this.next=void 0,this.val=n}};function gn(){}var En=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},Ma=xn();function qa(e){return globalThis.Buffer!=null?nt(e):Ma(e)}var Ke=class{len;head;tail;states;constructor(){this.len=0,this.head=new Ft(gn,0,0),this.tail=this.head,this.states=null}_push(t,r,n){return this.tail=this.tail.next=new Ft(t,r,n),this.len+=r,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Sn((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(hr,10,at.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let r=at.fromBigInt(t);return this._push(hr,r.length(),r)}uint64Number(t){return this._push(os,Ce(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let r=at.fromBigInt(t).zzEncode();return this._push(hr,r.length(),r)}sint64Number(t){let r=at.fromNumber(t).zzEncode();return this._push(hr,r.length(),r)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(wn,1,t?1:0)}fixed32(t){return this._push(Ue,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let r=at.fromBigInt(t);return this._push(Ue,4,r.lo)._push(Ue,4,r.hi)}fixed64Number(t){let r=at.fromNumber(t);return this._push(Ue,4,r.lo)._push(Ue,4,r.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(is,4,t)}double(t){return this._push(cs,8,t)}bytes(t){let r=t.length>>>0;return r===0?this._push(wn,1,0):this.uint32(r)._push(za,r,t)}string(t){let r=hs(t);return r!==0?this.uint32(r)._push(mn,r,t):this._push(wn,1,0)}fork(){return this.states=new En(this),this.head=this.tail=new Ft(gn,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ft(gn,0,0),this.len=0),this}ldelim(){let t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=r,this.len+=n),this}finish(){let t=this.head.next,r=qa(this.len),n=0;for(;t!=null;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r}};function wn(e,t,r){t[r]=e&255}function Va(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}var Sn=class extends Ft{next;constructor(t,r){super(Va,t,r),this.next=void 0}};function hr(e,t,r){for(;e.hi!==0;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}function Ue(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function za(e,t,r){t.set(e,r)}globalThis.Buffer!=null&&(Ke.prototype.bytes=function(e){let t=e.length>>>0;return this.uint32(t),t>0&&this._push(Fa,t,e),this},Ke.prototype.string=function(e){let t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(ja,t,e),this});function Fa(e,t,r){t.set(e,r)}function ja(e,t,r){e.length<40?mn(e,t,r):t.utf8Write!=null?t.utf8Write(e,r):t.set(It(e),r)}function An(){return new Ke}function lr(e,t){let r=An();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var he;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(he||(he={}));function dr(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Bn(e){function t(o){if(e[o.toString()]==null)throw new Error("Invalid enum value");return e[o]}let r=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return dr("enum",he.VARINT,r,n)}function pr(e,t){return dr("message",he.LENGTH_DELIMITED,e,t)}var ct;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.secp256k1="secp256k1",e.ECDSA="ECDSA"})(ct||(ct={}));var vn;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.secp256k1=2]="secp256k1",e[e.ECDSA=3]="ECDSA"})(vn||(vn={}));(function(e){e.codec=()=>Bn(vn)})(ct||(ct={}));var Pe;(function(e){let t;e.codec=()=>(t==null&&(t=pr((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.Type=ct.codec().decode(r);break}case 2:{s.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>lr(r,e.codec()),e.decode=(r,n)=>ur(r,e.codec(),n)})(Pe||(Pe={}));var In;(function(e){let t;e.codec=()=>(t==null&&(t=pr((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.Type=ct.codec().decode(r);break}case 2:{s.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>lr(r,e.codec()),e.decode=(r,n)=>ur(r,e.codec(),n)})(In||(In={}));var mr=class extends re{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,co(t);let n=Ae(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),Et(s)}update(t){return oe(this),this.iHash.update(t),this}digestInto(t){oe(this),W(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},_n=(e,t,r)=>new mr(e,t).update(r).digest();_n.create=(e,t)=>new mr(e,t);function ps(e){e.lowS!==void 0&&At("lowS",e.lowS),e.prehash!==void 0&&At("prehash",e.prehash)}var Ln=class extends Error{constructor(t=""){super(t)}},Bt={Err:Ln,_tlv:{encode:(e,t)=>{let{Err:r}=Bt;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=Le(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let s=n>127?Le(o.length/2|128):"";return Le(e)+s+o+t},decode(e,t){let{Err:r}=Bt,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let f=o&127;if(!f)throw new r("tlv.decode(long): indefinite length not supported");if(f>4)throw new r("tlv.decode(long): byte length is too big");let l=t.subarray(n,n+f);if(l.length!==f)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let c of l)i=i<<8|c;if(n+=f,i<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(e){let{Err:t}=Bt;if(e<Re)throw new t("integer: negative integers are not allowed");let r=Le(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Bt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return ie(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=Bt,o=k("signature",e),{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:f}=n.decode(2,s),{v:l,l:c}=n.decode(2,f);if(c.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=Bt,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),s=n+o;return t.encode(48,s)}},Re=BigInt(0),Ne=BigInt(1),Za=BigInt(2),yr=BigInt(3),Ya=BigInt(4);function Wa(e,t,r){function n(o){let s=e.sqr(o),i=e.mul(s,o);return e.add(e.add(i,e.mul(o,t)),r)}return n}function ms(e,t,r){let{BYTES:n}=e;function o(s){let i;if(typeof s=="bigint")i=s;else{let a=k("private key",s);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");let f=new Uint8Array(n);f.set(a,f.length-a.length),a=f}try{i=e.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof s}`)}}if(r&&(i=e.create(i)),!e.isValidNot0(i))throw new Error("invalid private key: out of range [1..N-1]");return i}return o}function $a(e,t={}){let{Fp:r,Fn:n}=rr("weierstrass",e,t),{h:o,n:s}=e;Ct(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=t;if(i&&(!r.is0(e.a)||typeof i.beta!="bigint"||typeof i.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function f(I,u,g){let{x:d,y}=u.toAffine(),w=r.toBytes(d);if(At("isCompressed",g),g){a();let _=!r.isOdd(y);return it(ys(_),w)}else return it(Uint8Array.of(4),w,r.toBytes(y))}function l(I){W(I);let u=r.BYTES,g=u+1,d=2*u+1,y=I.length,w=I[0],_=I.subarray(1);if(y===g&&(w===2||w===3)){let B=r.fromBytes(_);if(!r.isValid(B))throw new Error("bad point: is not on curve, wrong x");let L=x(B),P;try{P=r.sqrt(L)}catch(N){let R=N instanceof Error?": "+N.message:"";throw new Error("bad point: is not on curve, sqrt error"+R)}a();let K=r.isOdd(P);return(w&1)===1!==K&&(P=r.neg(P)),{x:B,y:P}}else if(y===d&&w===4){let B=r.fromBytes(_.subarray(u*0,u*1)),L=r.fromBytes(_.subarray(u*1,u*2));if(!b(B,L))throw new Error("bad point: is not on curve");return{x:B,y:L}}else throw new Error(`bad point: got length ${y}, expected compressed=${g} or uncompressed=${d}`)}let c=t.toBytes||f,h=t.fromBytes||l,x=Wa(r,e.a,e.b);function b(I,u){let g=r.sqr(u),d=x(I);return r.eql(g,d)}if(!b(e.Gx,e.Gy))throw new Error("bad curve params: generator point");let S=r.mul(r.pow(e.a,yr),Ya),E=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(S,E)))throw new Error("bad curve params: a or b");function m(I,u,g=!1){if(!r.isValid(u)||g&&r.is0(u))throw new Error(`bad point coordinate ${I}`);return u}function A(I){if(!(I instanceof p))throw new Error("ProjectivePoint expected")}let T=ce((I,u)=>{let{px:g,py:d,pz:y}=I;if(r.eql(y,r.ONE))return{x:g,y:d};let w=I.is0();u==null&&(u=w?r.ONE:r.inv(y));let _=r.mul(g,u),B=r.mul(d,u),L=r.mul(y,u);if(w)return{x:r.ZERO,y:r.ZERO};if(!r.eql(L,r.ONE))throw new Error("invZ was invalid");return{x:_,y:B}}),v=ce(I=>{if(I.is0()){if(t.allowInfinityPoint&&!r.is0(I.py))return;throw new Error("bad point: ZERO")}let{x:u,y:g}=I.toAffine();if(!r.isValid(u)||!r.isValid(g))throw new Error("bad point: x or y not field elements");if(!b(u,g))throw new Error("bad point: equation left != right");if(!I.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(I,u,g,d,y){return g=new p(r.mul(g.px,I),g.py,g.pz),u=fe(d,u),g=fe(y,g),u.add(g)}class p{constructor(u,g,d){this.px=m("x",u),this.py=m("y",g,!0),this.pz=m("z",d),Object.freeze(this)}static fromAffine(u){let{x:g,y:d}=u||{};if(!u||!r.isValid(g)||!r.isValid(d))throw new Error("invalid affine point");if(u instanceof p)throw new Error("projective point not allowed");return r.is0(g)&&r.is0(d)?p.ZERO:new p(g,d,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(u){return Qe(p,"pz",u)}static fromBytes(u){return W(u),p.fromHex(u)}static fromHex(u){let g=p.fromAffine(h(k("pointHex",u)));return g.assertValidity(),g}static fromPrivateKey(u){let g=ms(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return p.BASE.multiply(g(u))}static msm(u,g){return er(p,n,u,g)}precompute(u=8,g=!0){return D.setWindowSize(this,u),g||this.multiply(yr),this}_setWindowSize(u){this.precompute(u)}assertValidity(){v(this)}hasEvenY(){let{y:u}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(u)}equals(u){A(u);let{px:g,py:d,pz:y}=this,{px:w,py:_,pz:B}=u,L=r.eql(r.mul(g,B),r.mul(w,y)),P=r.eql(r.mul(d,B),r.mul(_,y));return L&&P}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:u,b:g}=e,d=r.mul(g,yr),{px:y,py:w,pz:_}=this,B=r.ZERO,L=r.ZERO,P=r.ZERO,K=r.mul(y,y),V=r.mul(w,w),N=r.mul(_,_),R=r.mul(y,w);return R=r.add(R,R),P=r.mul(y,_),P=r.add(P,P),B=r.mul(u,P),L=r.mul(d,N),L=r.add(B,L),B=r.sub(V,L),L=r.add(V,L),L=r.mul(B,L),B=r.mul(R,B),P=r.mul(d,P),N=r.mul(u,N),R=r.sub(K,N),R=r.mul(u,R),R=r.add(R,P),P=r.add(K,K),K=r.add(P,K),K=r.add(K,N),K=r.mul(K,R),L=r.add(L,K),N=r.mul(w,_),N=r.add(N,N),K=r.mul(N,R),B=r.sub(B,K),P=r.mul(N,V),P=r.add(P,P),P=r.add(P,P),new p(B,L,P)}add(u){A(u);let{px:g,py:d,pz:y}=this,{px:w,py:_,pz:B}=u,L=r.ZERO,P=r.ZERO,K=r.ZERO,V=e.a,N=r.mul(e.b,yr),R=r.mul(g,w),z=r.mul(d,_),j=r.mul(y,B),Y=r.add(g,d),O=r.add(w,_);Y=r.mul(Y,O),O=r.add(R,z),Y=r.sub(Y,O),O=r.add(g,y);let X=r.add(w,B);return O=r.mul(O,X),X=r.add(R,j),O=r.sub(O,X),X=r.add(d,y),L=r.add(_,B),X=r.mul(X,L),L=r.add(z,j),X=r.sub(X,L),K=r.mul(V,O),L=r.mul(N,j),K=r.add(L,K),L=r.sub(z,K),K=r.add(z,K),P=r.mul(L,K),z=r.add(R,R),z=r.add(z,R),j=r.mul(V,j),O=r.mul(N,O),z=r.add(z,j),j=r.sub(R,j),j=r.mul(V,j),O=r.add(O,j),R=r.mul(z,O),P=r.add(P,R),R=r.mul(X,O),L=r.mul(Y,L),L=r.sub(L,R),R=r.mul(Y,z),K=r.mul(X,K),K=r.add(K,R),new p(L,P,K)}subtract(u){return this.add(u.negate())}is0(){return this.equals(p.ZERO)}multiply(u){let{endo:g}=t;if(!n.isValidNot0(u))throw new Error("invalid scalar: out of range");let d,y,w=_=>D.wNAFCached(this,_,p.normalizeZ);if(g){let{k1neg:_,k1:B,k2neg:L,k2:P}=g.splitScalar(u),{p:K,f:V}=w(B),{p:N,f:R}=w(P);y=V.add(R),d=U(g.beta,K,N,_,L)}else{let{p:_,f:B}=w(u);d=_,y=B}return p.normalizeZ([d,y])[0]}multiplyUnsafe(u){let{endo:g}=t,d=this;if(!n.isValid(u))throw new Error("invalid scalar: out of range");if(u===Re||d.is0())return p.ZERO;if(u===Ne)return d;if(D.hasPrecomputes(this))return this.multiply(u);if(g){let{k1neg:y,k1:w,k2neg:_,k2:B}=g.splitScalar(u),{p1:L,p2:P}=jo(p,d,w,B);return U(g.beta,L,P,y,_)}else return D.wNAFCachedUnsafe(d,u)}multiplyAndAddUnsafe(u,g,d){let y=this.multiplyUnsafe(g).add(u.multiplyUnsafe(d));return y.is0()?void 0:y}toAffine(u){return T(this,u)}isTorsionFree(){let{isTorsionFree:u}=t;return o===Ne?!0:u?u(p,this):D.wNAFCachedUnsafe(this,s).is0()}clearCofactor(){let{clearCofactor:u}=t;return o===Ne?this:u?u(p,this):this.multiplyUnsafe(o)}toBytes(u=!0){return At("isCompressed",u),this.assertValidity(),c(p,this,u)}toRawBytes(u=!0){return this.toBytes(u)}toHex(u=!0){return mt(this.toBytes(u))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}p.BASE=new p(e.Gx,e.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO),p.Fp=r,p.Fn=n;let C=n.BITS,D=tr(p,t.endo?Math.ceil(C/2):C);return p}function ys(e){return Uint8Array.of(e?2:3)}function Xa(e,t,r={}){Ct(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let n=t.randomBytes||Be,o=t.hmac||((d,...y)=>_n(t.hash,d,it(...y))),{Fp:s,Fn:i}=e,{ORDER:a,BITS:f}=i;function l(d){let y=a>>Ne;return d>y}function c(d){return l(d)?i.neg(d):d}function h(d,y){if(!i.isValidNot0(y))throw new Error(`invalid signature ${d}: out of range 1..CURVE.n`)}class x{constructor(y,w,_){h("r",y),h("s",w),this.r=y,this.s=w,_!=null&&(this.recovery=_),Object.freeze(this)}static fromCompact(y){let w=i.BYTES,_=k("compactSignature",y,w*2);return new x(i.fromBytes(_.subarray(0,w)),i.fromBytes(_.subarray(w,w*2)))}static fromDER(y){let{r:w,s:_}=Bt.toSig(k("DER",y));return new x(w,_)}assertValidity(){}addRecoveryBit(y){return new x(this.r,this.s,y)}recoverPublicKey(y){let w=s.ORDER,{r:_,s:B,recovery:L}=this;if(L==null||![0,1,2,3].includes(L))throw new Error("recovery id invalid");if(a*Za<w&&L>1)throw new Error("recovery id is ambiguous for h>1 curve");let K=L===2||L===3?_+a:_;if(!s.isValid(K))throw new Error("recovery id 2 or 3 invalid");let V=s.toBytes(K),N=e.fromHex(it(ys((L&1)===0),V)),R=i.inv(K),z=v(k("msgHash",y)),j=i.create(-z*R),Y=i.create(B*R),O=e.BASE.multiplyUnsafe(j).add(N.multiplyUnsafe(Y));if(O.is0())throw new Error("point at infinify");return O.assertValidity(),O}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,i.neg(this.s),this.recovery):this}toBytes(y){if(y==="compact")return it(i.toBytes(this.r),i.toBytes(this.s));if(y==="der")return se(Bt.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return mt(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return mt(this.toBytes("compact"))}}let b=ms(i,r.allowedPrivateKeyLengths,r.wrapPrivateKey),S={isValidPrivateKey(d){try{return b(d),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{let d=a;return Ho(n(sn(d)),d)},precompute(d=8,y=e.BASE){return y.precompute(d,!1)}};function E(d,y=!0){return e.fromPrivateKey(d).toBytes(y)}function m(d){if(typeof d=="bigint")return!1;if(d instanceof e)return!0;let w=k("key",d).length,_=s.BYTES,B=_+1,L=2*_+1;if(!(r.allowedPrivateKeyLengths||i.BYTES===B))return w===B||w===L}function A(d,y,w=!0){if(m(d)===!0)throw new Error("first arg must be private key");if(m(y)===!1)throw new Error("second arg must be public key");return e.fromHex(y).multiply(b(d)).toBytes(w)}let T=t.bits2int||function(d){if(d.length>8192)throw new Error("input is too large");let y=ie(d),w=d.length*8-f;return w>0?y>>BigInt(w):y},v=t.bits2int_modN||function(d){return i.create(T(d))},U=Mt(f);function p(d){return Dt("num < 2^"+f,d,Re,U),i.toBytes(d)}function C(d,y,w=D){if(["recovered","canonical"].some(Y=>Y in w))throw new Error("sign() legacy options not supported");let{hash:_}=t,{lowS:B,prehash:L,extraEntropy:P}=w;B==null&&(B=!0),d=k("msgHash",d),ps(w),L&&(d=k("prehashed msgHash",_(d)));let K=v(d),V=b(y),N=[p(V),p(K)];if(P!=null&&P!==!1){let Y=P===!0?n(s.BYTES):P;N.push(k("extraEntropy",Y))}let R=it(...N),z=K;function j(Y){let O=T(Y);if(!i.isValidNot0(O))return;let X=i.inv(O),de=e.BASE.multiply(O).toAffine(),jt=i.create(de.x);if(jt===Re)return;let Pt=i.create(X*i.create(z+jt*V));if(Pt===Re)return;let gr=(de.x===jt?0:2)|Number(de.y&Ne),Gt=Pt;return B&&l(Pt)&&(Gt=c(Pt),gr^=1),new x(jt,Gt,gr)}return{seed:R,k2sig:j}}let D={lowS:t.lowS,prehash:!1},I={lowS:t.lowS,prehash:!1};function u(d,y,w=D){let{seed:_,k2sig:B}=C(d,y,w);return To(t.hash.outputLen,i.BYTES,o)(_,B)}e.BASE.precompute(8);function g(d,y,w,_=I){let B=d;y=k("msgHash",y),w=k("publicKey",w),ps(_);let{lowS:L,prehash:P,format:K}=_;if("strict"in _)throw new Error("options.strict was renamed to lowS");if(K!==void 0&&!["compact","der","js"].includes(K))throw new Error('format must be "compact", "der" or "js"');let V=typeof B=="string"||ne(B),N=!V&&!K&&typeof B=="object"&&B!==null&&typeof B.r=="bigint"&&typeof B.s=="bigint";if(!V&&!N)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let R,z;try{if(N)if(K===void 0||K==="js")R=new x(B.r,B.s);else throw new Error("invalid format");if(V){try{K!=="compact"&&(R=x.fromDER(B))}catch(Gt){if(!(Gt instanceof Bt.Err))throw Gt}!R&&K!=="der"&&(R=x.fromCompact(B))}z=e.fromHex(w)}catch{return!1}if(!R||L&&R.hasHighS())return!1;P&&(y=t.hash(y));let{r:j,s:Y}=R,O=v(y),X=i.inv(Y),de=i.create(O*X),jt=i.create(j*X),Pt=e.BASE.multiplyUnsafe(de).add(z.multiplyUnsafe(jt));return Pt.is0()?!1:i.create(Pt.x)===j}return Object.freeze({getPublicKey:E,getSharedSecret:A,sign:u,verify:g,utils:S,Point:e,Signature:x})}function Ja(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=lt(t.n,e.nBitLength),o={Fp:r,Fn:n,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:o}}function Qa(e){let{CURVE:t,curveOpts:r}=Ja(e),n={hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,ecdsaOpts:n}}function tc(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}function bs(e){let{CURVE:t,curveOpts:r,ecdsaOpts:n}=Qa(e),o=$a(t,r),s=Xa(o,n,r);return tc(e,s)}function xs(e,t){let r=n=>bs({...e,hash:n});return{...r(t),create:r}}var br={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Oh=BigInt(0),ec=BigInt(1),Tn=BigInt(2),gs=(e,t)=>(e+t/Tn)/t;function rc(e){let t=br.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),f=BigInt(88),l=e*e*e%t,c=l*l*e%t,h=H(c,r,t)*c%t,x=H(h,r,t)*c%t,b=H(x,Tn,t)*l%t,S=H(b,o,t)*b%t,E=H(S,s,t)*S%t,m=H(E,a,t)*E%t,A=H(m,f,t)*m%t,T=H(A,a,t)*E%t,v=H(T,r,t)*c%t,U=H(v,i,t)*S%t,p=H(U,n,t)*l%t,C=H(p,Tn,t);if(!Dn.eql(Dn.sqr(C),e))throw new Error("Cannot find square root");return C}var Dn=lt(br.p,void 0,void 0,{sqrt:rc}),le=xs({...br,Fp:Dn,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=br.n,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ec*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,i=BigInt("0x100000000000000000000000000000000"),a=gs(s*e,t),f=gs(-n*e,t),l=M(e-a*r-f*o,t),c=M(-a*n-f*s,t),h=l>i,x=c>i;if(h&&(l=t-l),x&&(c=t-c),l>i||c>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:x,k2:c}}}},Bo);function ws(e,t,r,n){let o=ge.digest(r instanceof Uint8Array?r:r.subarray());if(ar(o))return o.then(({digest:s})=>(n?.signal?.throwIfAborted(),le.verify(t,s,e))).catch(s=>{throw s.name==="AbortError"?s:new De(String(s))});try{return n?.signal?.throwIfAborted(),le.verify(t,o.digest,e)}catch(s){throw new De(String(s))}}var xr=class{type="secp256k1";raw;_key;constructor(t){this._key=Ss(t),this.raw=Es(this._key)}toMultihash(){return ft.digest(ee(this))}toCID(){return J.createV1(114,this.toMultihash())}toString(){return F.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ut(this.raw,t.raw)}verify(t,r,n){return ws(this._key,r,t,n)}};function As(e){return new xr(e)}function Es(e){return le.ProjectivePoint.fromHex(e).toRawBytes(!0)}function Ss(e){try{return le.ProjectivePoint.fromHex(e),e}catch(t){throw new Ve(String(t))}}function Bs(e){let{Type:t,Data:r}=Pe.decode(e.digest),n=r??new Uint8Array;switch(t){case ct.Ed25519:return Qo(n);case ct.secp256k1:return As(n);case ct.ECDSA:return oo(n);default:throw new Zt}}function ee(e){return Pe.encode({Type:ct[e.type],Data:e.raw})}var vs=Symbol.for("nodejs.util.inspect.custom"),nc=114,Oe=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Er]=!0;toString(){return this.string==null&&(this.string=F.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return J.createV1(nc,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return ut(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return ut(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[vs](){return`PeerId(${this.toString()})`}},ke=class extends Oe{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},He=class extends Oe{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},Me=class extends Oe{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},oc=2336,qe=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=ft.digest(It(this.url))}[vs](){return`PeerId(${this.url})`}[Er]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return J.createV1(oc,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=st(t)),t.toString()===this.toString())}};var sc=114,Is=2336;function ic(e,t){let r;if(e.charAt(0)==="1"||e.charAt(0)==="Q")r=be(F.decode(`z${e}`));else{if(e.startsWith("k51qzi5uqu5")||e.startsWith("kzwfwjn5ji4")||e.startsWith("k2k4r8")||e.startsWith("bafz"))return Ls(J.parse(e));if(t==null)throw new pt('Please pass a multibase decoder for strings that do not start with "1" or "Q"');r=be(t.decode(e))}return Cn(r)}function _s(e){if(e.type==="Ed25519")return new He({multihash:e.toCID().multihash,publicKey:e});if(e.type==="secp256k1")return new Me({multihash:e.toCID().multihash,publicKey:e});if(e.type==="RSA")return new ke({multihash:e.toCID().multihash,publicKey:e});throw new Zt}function ac(e){return _s(e.publicKey)}function Cn(e){if(fc(e))return new ke({multihash:e});if(cc(e))try{let t=Bs(e);if(t.type==="Ed25519")return new He({multihash:e,publicKey:t});if(t.type==="secp256k1")return new Me({multihash:e,publicKey:t})}catch{let r=st(e.digest);return new qe(new URL(r))}throw new Fe("Supplied PeerID Multihash is invalid")}function Ls(e){if(e?.multihash==null||e.version==null||e.version===1&&e.code!==sc&&e.code!==Is)throw new ze("Supplied PeerID CID is invalid");if(e.code===Is){let t=st(e.multihash.digest);return new qe(new URL(t))}return Cn(e.multihash)}function cc(e){return e.code===ft.code}function fc(e){return e.code===ge.code}return Ks(uc);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/edwards.js:
@noble/curves/esm/ed25519.js:
@noble/curves/esm/abstract/weierstrass.js:
@noble/curves/esm/_shortw_utils.js:
@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerId}));
//# sourceMappingURL=index.min.js.map
